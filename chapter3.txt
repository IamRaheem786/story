This is chapter3 of MAIN branch..